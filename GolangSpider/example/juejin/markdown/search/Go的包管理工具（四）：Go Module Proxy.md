# Goçš„åŒ…ç®¡ç†å·¥å…·ï¼ˆå››ï¼‰ï¼šGo Module Proxy #

åœ¨å‰é¢çš„æ–‡ç« ï¼Œæˆ‘ä»¬ä»‹ç»äº† ` Go Modules` ( https://link.juejin.im?target=http%3A%2F%2Fblueskykong.com%2F2019%2F03%2F01%2Fgo-dep-3%2F ) ã€‚Go moduleæ”¯æŒäº†Versioned Goï¼Œå¹¶åˆæ­¥è§£å†³äº†åŒ…ä¾èµ–ç®¡ç†çš„é—®é¢˜ã€‚

æ–°çš„å·¥ä½œæ¨¡å¼ä¹Ÿå¸¦æ¥äº†ä¸€äº›é—®é¢˜ï¼Œåœ¨å¤§é™†åœ°åŒºæˆ‘ä»¬æ— æ³•ç›´æ¥é€šè¿‡ ` go get` å‘½ä»¤è·å–åˆ°ä¸€äº›ç¬¬ä¸‰æ–¹åŒ…ï¼Œæœ€å¸¸è§çš„å°±æ˜¯ ` golang.org/x` ä¸‹é¢çš„å„ç§ä¼˜ç§€çš„åŒ…ã€‚ä¸€æ—¦å·¥ä½œåœ¨æ¨¡å—ä¸‹ï¼Œ ` go build` å°†ä¸å†å…³å¿ƒ GOPATH æˆ–æ˜¯ vendor ä¸‹çš„åŒ…ï¼Œè€Œæ˜¯åˆ° ` GOPATH/pkg/mod` æŸ¥è¯¢æ˜¯å¦æœ‰cacheï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ä¼šå»ä¸‹è½½æŸä¸ªç‰ˆæœ¬çš„ moduleï¼Œè€Œå¯¹äºæŸäº›åŒ…çš„ moduleï¼Œåœ¨å¤§é™†åœ°åŒºå¾€å¾€ä¼šå¤±è´¥ã€‚æœ¬æ–‡å°†é‡ç‚¹ä»‹ç» go module çš„ proxy é…ç½®å®ç°ï¼ŒåŒ…æ‹¬å¦‚ä¸‹ä¸¤ç§çš„ä»£ç†é…ç½®ï¼š

* GOPROXY
* Athens

## GOPROXY ##

goproxy æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå½“ç”¨æˆ·è¯·æ±‚ä¸€ä¸ªä¾èµ–åº“æ—¶ï¼Œå¦‚æœå®ƒå‘ç°æœ¬åœ°æ²¡æœ‰è¿™ä»½ä»£ç å°±ä¼šè‡ªåŠ¨è¯·æ±‚æºï¼Œç„¶åç¼“å­˜åˆ°æœ¬åœ°ï¼Œç”¨æˆ·å°±å¯ä»¥ä» goproxy.io è¯·æ±‚åˆ°æ•°æ®ã€‚å½“ç„¶ï¼Œè¿™äº›éƒ½æ˜¯åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­å®Œæˆçš„ã€‚goproxy.io åªæ”¯æŒ go module æ¨¡å¼ã€‚å½“ç”¨æˆ·æ‰§è¡Œ go get å‘½ä»¤æ—¶ï¼Œä¼šå»æ£€æŸ¥ ` $GOPROXY//@v/list` è¿™ä¸ªæ–‡ä»¶ä¸­æ˜¯å¦æœ‰ç”¨æˆ·æƒ³è¦è·å–çš„ç‰ˆæœ¬ï¼Œå¦‚æœæœ‰ï¼Œå°±ä¾æ¬¡è·å– ` $GOPROXY//@v/.info` ã€ ` $GOPROXY//@v/.mod` ã€ ` $GOPROXY//@v/.zip` ç­‰æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰å°±ç›´æ¥ä»æºç åº“ä¸­å»ä¸‹è½½ã€‚

é€šè¿‡å‘½ä»¤ï¼š

` export GOPROXY=https://goproxy.io å¤åˆ¶ä»£ç `

è®¾ç½®äº†è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œä¸€æ—¦è®¾ç½®ç”Ÿæ•ˆï¼Œåç»­ go å‘½ä»¤ä¼šé€šè¿‡ ` go module download protocol` ä¸ ` proxy` äº¤äº’ä¸‹è½½ç‰¹å®šç‰ˆæœ¬çš„ ` module` ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç½®ç©º ` GOPROXY` å˜é‡ï¼Œæ¥å…³é—­ ` GOPROXY` ä»£ç†ã€‚

è¯¦è§ï¼š [github.com/goproxyio/gâ€¦]( https://link.juejin.im?target=https%3A%2F%2Fgithub.com%2Fgoproxyio%2Fgoproxy )

## Athens ##

![](https://user-gold-cdn.xitu.io/2019/3/18/169910a7a5c77085?imageView2/0/w/1280/h/960/ignore-error/1) Athens æ˜¯ä¸€ä¸ªå»ºç«‹åœ¨ vgoï¼ˆæˆ–è€…æ˜¯1.11 +ï¼‰ä¹‹ä¸Šçš„é¡¹ç›®ï¼Œè¯•å›¾è®©ä¾èµ–å…³ç³»æ›´æ¥è¿‘ä½ ï¼Œå³ä½¿åœ¨ VCS å…³é—­æ—¶ä½ ä¹Ÿå¯ä»¥ä¾èµ–å¯é‡å¤çš„æ„å»ºã€‚

ä¾èµ–å…³ç³»æ˜¯æ¥è‡ª Github çš„ä¸å¯å˜çš„ä»£ç å—å’Œç›¸å…³çš„å…ƒæ•°æ®ã€‚ ä»–ä»¬å­˜å‚¨åœ¨ Athens æ§åˆ¶çš„ä»“åº“é‡Œã€‚

æ‚¨å¯èƒ½å·²ç»çŸ¥é“â€œä¸å¯å˜â€æ„å‘³ç€ä»€ä¹ˆï¼Œä½†è®©æˆ‘å†æ¬¡æŒ‡å‡ºå®ƒï¼Œå› ä¸ºå®ƒå¯¹æ•´ä¸ªç³»ç»Ÿéå¸¸é‡è¦ã€‚å½“äººä»¬æ”¹å˜ä»–ä»¬çš„åŒ…ï¼Œè¿­ä»£ï¼Œå®éªŒæˆ–å…¶ä»–ä»»ä½•ä¸œè¥¿æ—¶ï¼ŒAthens çš„ä»£ç éƒ½ä¸ä¼šæ”¹å˜ã€‚å¦‚æœè½¯ä»¶åŒ…ä½œè€…å‘å¸ƒäº†ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼ŒAthens å°†æŠŠå®ƒæ‹‰ä¸‹æ¥ã€‚æ¯”å¦‚æŸä¸ªé¡¹ç›®ä¾èµ–äºåŒ… M ç‰ˆ ` v1.2.3` ï¼Œå®ƒå°†æ°¸è¿œä¸ä¼šæ”¹å˜ Athens ä¸Šçš„åŒ…ã€‚

### å®‰è£… ###

Athens æ”¯æŒå¤šç§æ–¹å¼çš„å®‰è£…ï¼Œdocker å®¹å™¨ã€k8s å’ŒäºŒè¿›åˆ¶å®‰è£…åŒ…ï¼Œæœ¬æ–‡å°†ä¼šä»‹ç»å¦‚ä½•é€šè¿‡äºŒè¿›åˆ¶åŒ…å®‰è£…ã€‚

` git clone https://github.com/gomods/athens cd athens make build-ver VERSION= "0.2.0" å¤åˆ¶ä»£ç ` `./athens -version å¤åˆ¶ä»£ç `

### è·å–ç§æœ‰ä»“åº“ ###

Athens è·å–ç§æœ‰ä»“åº“ä¸­çš„ moduleï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªä¼ä¸šçº§çš„éœ€æ±‚ã€‚é€šå¸¸ä¼ä¸šç§æœ‰ä»“åº“éƒ½æ˜¯éœ€è¦èº«ä»½éªŒè¯çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨ Athens ä¸­é…ç½®è®¿é—®ç§æœ‰ä»“åº“çš„è´¦å·å’Œå‡­è¯ä¿¡æ¯ã€‚ç›®å‰ Athens å®˜æ–¹æ–‡æ¡£ä¸­æä¾›äº†é€šè¿‡ `.netrc` æ–¹å¼è®¿é—®å¸¦æœ‰èº«ä»½éªŒè¯çš„ç§æœ‰ä»“åº“çš„åŠŸèƒ½ã€‚

é€šè¿‡åˆ›å»º `.netrc` æ–‡ä»¶ï¼Œè¿›è¡Œç§æœ‰ä»“åº“èº«ä»½éªŒè¯ã€‚

` //.netrc machine github.com login MY_USERNAME password MY_PASSWORD å¤åˆ¶ä»£ç `

### æœ¬åœ°åº”ç”¨ ###

` export GO111MODULE=on export GOPROXY=http://127.0.0.1:3000 å¤åˆ¶ä»£ç `

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Athens æä¾›çš„ ` walkthrough` ã€‚

` git clone https://github.com/athens-artifacts/walkthrough.git å¤åˆ¶ä»£ç ` ` $ cd../walkthrough $ go run . go: finding github.com/athens-artifacts/samplelib v1.0.0 handler: GET /github.com/athens-artifacts/samplelib/@v/v1.0.0.info [200] handler: GET /github.com/athens-artifacts/samplelib/@v/v1.0.0.mod [200] go: downloading github.com/athens-artifacts/samplelib v1.0.0 handler: GET /github.com/athens-artifacts/samplelib/@v/v1.0.0.zip [200] The ğŸ¦ says rawr! å¤åˆ¶ä»£ç `

` go run .` çš„è¾“å‡ºåŒ…æ‹¬å°è¯•æŸ¥æ‰¾ ` github.com/athens-artifacts/samplelib` ä¾èµ–é¡¹ã€‚ç”±äºä»£ç†æ˜¯åœ¨åå°è¿è¡Œçš„ï¼Œå› æ­¤è¿˜å¯ä»¥çœ‹åˆ°æ¥è‡ª Athens çš„è¾“å‡ºï¼Œè¡¨æ˜å®ƒæ­£åœ¨å¤„ç†å¯¹ä¾èµ–é¡¹çš„è¯·æ±‚ã€‚

### global public proxy ###

Athens è¿˜æä¾›äº†ä¸€ä¸ªè¯•éªŒæ€§çš„ proxyï¼š ` athens.azurefd.net` ä¾›å…¨çƒgopher ä½¿ç”¨ã€‚å¯¼å…¥ç¯å¢ƒå˜é‡ï¼š

` export GOPROXY= "https://athens.azurefd.net" å¤åˆ¶ä»£ç `

å½“ç„¶è™½ç„¶å¯ä»¥ä½¿ç”¨è¿™äº›å…¬æœ‰çš„ä»£ç†ï¼Œä½†æ˜¯åŒ…çš„æºå¹¶ä¸æ˜¯å¾ˆå…¨ï¼Œæœ€ç¨³å¦¥çš„æ–¹æ³•è¿˜æ˜¯è‡ªå»º Athens æœåŠ¡ã€‚å®˜æ–¹issueä¸­æ‰€è¯´ï¼š

> 
> 
> 
> ` athens.azurefd.net` å¤„äº alpha çš„ç‰ˆæœ¬ï¼Œç›®å‰åŸºç¡€è®¾æ–½è¿˜æ²¡æœ‰å¾ˆå¥½åœ°ç»´æŠ¤ï¼Œæ‰€ä»¥çœ‹åˆ°è¶…æ—¶å¹¶ä¸æ„Ÿåˆ°æƒŠè®¶ã€‚è‡ªå»º ` Athens`
> æˆ–ä½¿ç”¨ GoCenterï¼ˆç›®å‰å”¯ä¸€çš„æ‰˜ç®¡Goæ¨¡å—å­˜å‚¨åº“ï¼‰ã€‚
> 
> 

#### æ¨èé˜…è¯» ####

[Goçš„åŒ…ç®¡ç†å·¥å…·]( https://link.juejin.im?target=http%3A%2F%2Fblueskykong.com%2Ftags%2F%25E5%258C%2585%25E7%25AE%25A1%25E7%2590%2586%2F )

#### è®¢é˜…æœ€æ–°æ–‡ç« ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å· ####

![å¾®ä¿¡å…¬ä¼—å·](https://user-gold-cdn.xitu.io/2019/3/18/169910879f2ba8e3?imageView2/0/w/1280/h/960/ignore-error/1)

#### å‚è€ƒ ####

* [Athens docs]( https://link.juejin.im?target=https%3A%2F%2Fdocs.gomods.io )
* [å†æ¢go modulesï¼šä½¿ç”¨ä¸ç»†èŠ‚]( https://link.juejin.im?target=https%3A%2F%2Fwww.cnblogs.com%2Fapocelipes%2Fp%2F10295096.html )